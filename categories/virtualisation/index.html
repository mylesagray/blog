<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Virtualisation | Blah, Cloud</title><meta name=keywords content><meta name=description content="Adventures in architectures"><meta name=author content="Myles Gray"><link rel=canonical href=https://blah.cloud/categories/virtualisation/><link crossorigin=anonymous href=/assets/css/stylesheet.min.b1da2895238dfeedf27f032004268905e3f3ba403dec0ceb07be46cce8ac5b96.css integrity="sha256-sdoolSON/u3yfwMgBCaJBePzukA97AzrB75GzOisW5Y=" rel="preload stylesheet" as=style><link rel=icon href=https://blah.cloud/images/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blah.cloud/images/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blah.cloud/images/favicon-32x32.png><link rel=apple-touch-icon href=https://blah.cloud/images/apple-touch-icon.png><link rel=mask-icon href=https://blah.cloud/images/logo.png><meta name=theme-color media="(prefers-color-scheme: dark)" content="rgba(88, 89, 91, 1)"><meta name=theme-color content="rgba(240, 202, 102, 1)"><meta name=msapplication-TileColor content="rgba(240, 202, 102, 1)"><meta name=generator content="Hugo 0.110.0"><link rel=alternate type=application/rss+xml href=https://blah.cloud/categories/virtualisation/index.xml><meta property="og:title" content="Virtualisation"><meta property="og:description" content="Adventures in architectures"><meta property="og:type" content="website"><meta property="og:url" content="https://blah.cloud/categories/virtualisation/"><meta property="og:image" content="https://blah.cloud/images/og-card.jpg"><meta property="og:site_name" content="Blah, Cloud"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blah.cloud/images/og-card.jpg"><meta name=twitter:title content="Virtualisation"><meta name=twitter:description content="Adventures in architectures"><meta name=twitter:site content="@mylesagray"><meta name=twitter:creator content="@mylesagray"><script defer data-domain=blah.cloud data-api=/backend/api/event src=/backend/js/script.outbound-links.js></script>
<script>window.plausible=window.plausible||function(){(window.plausible.q=window.plausible.q||[]).push(arguments)}</script></head><body class=list id=top><script>window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?(document.body.classList.add("dark"),document.body.classList.remove("light")):(document.body.classList.remove("dark"),document.body.classList.add("light"));const darkModeMediaQuery=window.matchMedia("(prefers-color-scheme: dark)");darkModeMediaQuery.addListener(e=>{const t=e.matches;t?(document.body.classList.add("dark"),document.body.classList.remove("light")):(document.body.classList.remove("dark"),document.body.classList.add("light"))})</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(240, 202, 102, 1);--secondary:rgba(216, 214, 197, 1);--tertiary:rgb(75, 75, 75);--content:rgba(206, 205, 188, 1);--hljs-bg:#282a36;--code-bg:#282a36;--border:rgba(240, 202, 102, 1);--highlight:rgba(88, 89, 91, 1)}.list{background:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://blah.cloud/ accesskey=h title="Blah, Cloud. (Alt + H)"><picture><source media="(min-width: 768px)" srcset=/images/logo-title.avif type=image/avif alt=logo width=245 height=34><source media="(min-width: 768px)" srcset=/images/logo-title.webp type=image/webp alt=logo width=245 height=34><source media="(min-width: 768px)" srcset=/images/logo-title.png type=image/png alt=logo width=245 height=34><source srcset=/images/logo.avif type=image/avif alt=logo width=65 height=65><source srcset=/images/logo.webp type=image/webp alt=logo width=65 height=65><img class=logo src=/images/logo-title.png alt=logo aria-label=logo width=245 height=34></picture></a></div><span class=logo-switches></span><span class=hamburger><button id=hamburger-toggle accesskey=m title="(Alt + M)"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="28" viewBox="0 0 24 28"><path d="M24 21v2c0 .547-.453 1-1 1H1c-.547.0-1-.453-1-1v-2c0-.547.453-1 1-1h22c.547.0 1 .453 1 1zm0-8v2c0 .547-.453 1-1 1H1c-.547.0-1-.453-1-1v-2c0-.547.453-1 1-1h22c.547.0 1 .453 1 1zm0-8v2c0 .547-.453 1-1 1H1c-.547.0-1-.453-1-1V5c0-.547.453-1 1-1h22c.547.0 1 .453 1 1z"/></svg></button></span><ul id=menu><li><a href=https://blah.cloud/now/ title=now><span>now</span></a></li><li><a href=https://blah.cloud/blog/ title=blog><span>blog</span></a></li><li><a href=https://blah.cloud/bio/ title=bio><span>bio</span></a></li><li><a href=https://blah.cloud/works/ title=works><span>works</span></a></li><li><a href=https://blah.cloud/search/ title=" (Alt + /)" accesskey=/><span><svg style="height:1em" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="fill-current w-5" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></a></li></ul></nav></header><div class=container><main class=main><header class=page-header><h1>Virtualisation</h1></header><article class="post-entry tag-entry"><header class=entry-header><h2>vSAN SPBM and vCloud Director</h2></header><section class=entry-content><p>I had a question last week from Bozo Popovic ↗ during our EMEA field SE training session on vSAN operations relating to SPBM support for service providers that use vCloud Director in their environments.
Next up Mr. @mylesagray giving a #vSAN operations overview to our EMEA field at the @vmwarevsan workshop this morning pic.twitter.com/48seQc8i7d
— Cormac Hogan (@CormacJHogan) November 30, 2017 I am stating this for clarity - since the vCD 9....</p></section><footer class=entry-footer><span title='2017-12-02 13:31:36 +0000 UTC'>December 2, 2017</span>&nbsp;·&nbsp;Myles Gray</footer><a class=entry-link aria-label="post link to vSAN SPBM and vCloud Director" href=https://blah.cloud/cloud/vsan-spbm-vcloud-director/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Migrating vSAN vmkernel ports to a new subnet</h2></header><section class=entry-content><p>After deploying a vSAN cluster, the need sometimes arises to make changes to its network configuration, such as migrating the vmkernel network of the cluster to a new subnet. This requirement may appear for example when changing the network in which the vSAN cluster is running, or even, in a more complex scenario such as when a standalone vSAN needs to be converted to a stretched cluster.
In these sorts of situations, complications may be encountered if the subnet in use for the vSAN vmkernel ports cannot be routed to the network as a whole, as it is in use elsewhere in the organization, and is currently isolated in an L2 segment....</p></section><footer class=entry-footer><span title='2017-11-03 14:01:47 +0000 UTC'>November 3, 2017</span>&nbsp;·&nbsp;Myles Gray</footer><a class=entry-link aria-label="post link to Migrating vSAN vmkernel ports to a new subnet" href=https://blah.cloud/infrastructure/migrating-vsan-vmkernel-ports-new-subnet/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>vCloud Director console proxy and UI on a single interface</h2></header><section class=entry-content><p>I was recently rebuilding part of my lab infrastructure, and as part of it, I wanted to migrate my vCD cells from two IPs each to a single IP (as this feature was added in vCD 8.10 ↗) for both the web UI and the console proxy.
It simplifies provisioning, potential routing problems, and load-balancer configuration by having a single IP but separate ports for each service. Adding both services to a single IP is not new, Tomas Fjota wrote about it here ↗, however, there was some detail missing from his article to allow it to work behind a load-balancer....</p></section><footer class=entry-footer><span title='2017-08-20 17:09:08 +0000 UTC'>August 20, 2017</span>&nbsp;·&nbsp;Myles Gray</footer><a class=entry-link aria-label="post link to vCloud Director console proxy and UI on a single interface" href=https://blah.cloud/cloud/vcloud-director-console-proxy-ui-single-ip/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Customer, Partner, Vendor.</h2></header><section class=entry-content><p>Over the last 9 months, a lot has happened in my life; I have a nice titanium plate in my shoulder now courtesy of a major car accident. I changed roles at Novosco ↗ from Infrastructure Engineer to Cloud Technologist - focusing more on R&D and emerging platforms, and I helped out Frank Denneman ↗ and Niels Hagoort ↗ in editing their best-selling vSphere 6.5 Host Deep Dive book ↗....</p></section><footer class=entry-footer><span title='2017-07-18 11:17:15 +0000 UTC'>July 18, 2017</span>&nbsp;·&nbsp;Myles Gray</footer><a class=entry-link aria-label="post link to Customer, Partner, Vendor." href=https://blah.cloud/infrastructure/customer-partner-vendor/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Implementing a multi-tenant networking platform with NSX</h2></header><section class=entry-content><p>So we have covered the typical challenges of a multi-tenant network and designed a solution to one of these, it’s time to get down to the bones of it and do some configuration! Let’s implement it in the lab, I have set up an NSX ESG Cust_1-ESG and an NSX DLR control VM Cust_1-DLR with the below IP configuration:
I have also enabled OSPF as a NSSA (area 51) between the ESG and the DLR control VM and specified to redistribute connected routes attached to the DLR:...</p></section><footer class=entry-footer><span title='2017-03-23 18:38:57 +0000 UTC'>March 23, 2017</span>&nbsp;·&nbsp;Myles Gray</footer><a class=entry-link aria-label="post link to Implementing a multi-tenant networking platform with NSX" href=https://blah.cloud/networks/implementing-multi-tenant-networking-platform-nsx/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Recovering NSX Manager with corrupt filesystem</h2></header><section class=entry-content><p>I had a bit of a storage outage in my lab due to a funky behaviour on the Synology that I use as primary storage for all my VMs.
Most stuff came back up or could at least be trivially fixed (like VCSA, PSCs, etc) you can edit the GRUB boot string ↗ and force into /bin/bash then run fsck from there.
One VM that doesn’t allow the GRUB string to be edited or both to be paused in any way is the NSX manager, that was a problem given I was presented with this upon boot:...</p></section><footer class=entry-footer><span title='2016-11-13 19:15:30 +0000 UTC'>November 13, 2016</span>&nbsp;·&nbsp;Myles Gray</footer><a class=entry-link aria-label="post link to Recovering NSX Manager with corrupt filesystem" href=https://blah.cloud/virtualisation/recovering-nsx-manager-corrupt-filesystem/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Migrating from VCSA embedded PSC to external PSC</h2></header><section class=entry-content><p>On a bit of a shorter note to my previous article/novella ↗ - I have been moving my lab to a bit more of an “enterprise” style architecture - deploying SRM was in the way for that, so I had the need to set up another vCenter, however this gave the opportunity to move to a multi-PSC, multi-VC architecture.
There is quite some complexity in my lab with regard to vCenter and its integrations, I have running in production vRO, NSX and vCD - it’s also plugged into VIO and VR, so naturally I really don’t want to reinstall all these components and reconfigure them as a lot of work has gone in, in particular with NSX, dynamic peering etc set up with upstream routers and its integration with vCD....</p></section><footer class=entry-footer><span title='2016-10-30 20:09:02 +0000 UTC'>October 30, 2016</span>&nbsp;·&nbsp;Myles Gray</footer><a class=entry-link aria-label="post link to Migrating from VCSA embedded PSC to external PSC" href=https://blah.cloud/virtualisation/migrating-vcsa-embedded-psc-external-psc/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Replicating SAN on openSUSE with VAAI</h2></header><section class=entry-content><p>Preamble This article was written a few years back, but never published - it was some work I was doing in my lab to try and get to grips around the work involved in creating a SAN with synchronous replication built in from scratch.
It in no way should be used for production, but rather as a learning exercise - as previously stated the instructions are a few years old and version specific, so openSUSE may well now support some of the modules I had to compile and create repos for manually, also DRBD9 has been released and should obviously be used in place of DRBD8 as I have below....</p></section><footer class=entry-footer><span title='2016-08-27 12:59:18 +0000 UTC'>August 27, 2016</span>&nbsp;·&nbsp;Myles Gray</footer><a class=entry-link aria-label="post link to Replicating SAN on openSUSE with VAAI" href=https://blah.cloud/hardware/replicating-san-opensuse-vaai/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Configuring Auto Deploy Stateless Caching in vSphere 6.0</h2></header><section class=entry-content><p>Following on from my previous post on configuring custom ESXi images for PXE deployment, it piqued my interest again in Auto Deploy, now that I have a lab large enough (enough physical failure domains) to justify auto-deploy I figured i’d give it another go. I have chosen to implement stateless caching as it will allow the hosts to boot from the last used ESXi image they had if the PxE/AutoDeploy server goes down - then when it comes back up will pull the new version, this accounts for a total infrastructure outage and still allows the hosts to be bootable....</p></section><footer class=entry-footer><span title='2016-08-19 21:53:33 +0000 UTC'>August 19, 2016</span>&nbsp;·&nbsp;Myles Gray</footer><a class=entry-link aria-label="post link to Configuring Auto Deploy Stateless Caching in vSphere 6.0" href=https://blah.cloud/automation/configuring-auto-deploy-stateless-caching-vsphere-6-0/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Building a customised ESXi image for PXE installation</h2></header><section class=entry-content><p>Introduction I have recently been working on a larger scale platform for my employer, it requires quick deployments of environments on VSAN with some standardised VIBs added in, initially we were doing this with a standard ESXi ISO install through iDRAC and then installing vCenter, vSphere Update Manager and pushing the VIBs to the hosts via that.
This is clearly a sub-optimal process and given our dedicated lab environment, we wanted to be able to spin up/down environments a bit more quickly - so we looked to optimising the install process and making production ready as the first step (as most people know, VSAN has some stringent HCL requirements when it comes to drivers and firmware)....</p></section><footer class=entry-footer><span title='2016-08-09 12:40:27 +0000 UTC'>August 9, 2016</span>&nbsp;·&nbsp;Myles Gray</footer><a class=entry-link aria-label="post link to Building a customised ESXi image for PXE installation" href=https://blah.cloud/infrastructure/building-customised-esxi-image-pxe-installation/></a></article><footer class=page-footer><nav class=pagination><a class=next href=https://blah.cloud/categories/virtualisation/page/2/>Next Page »</a></nav></footer></main></div><footer class=footer><span>&copy; 2023 <a href=https://blah.cloud/>Blah, Cloud</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/JPbaU rel=noopener target=_blank>BurgerMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></body></html>